(()=>{"use strict";var e={6752:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=r(n(8186)),a=r(n(2166)),u=r(n(8966)),s=r(n(1845)),l=r(n(2743)),d=n(8394),f=r(n(3582)),c=(0,i.default)(),h=process.env.PORT||3e3;(0,o.default)(),c.use(i.default.json()),c.use((0,f.default)()),c.use("/api/public",a.default),c.use("/api/auth",u.default),c.use("/api/user",s.default),c.use("/api/admin",l.default),c.use(d.notFound),c.use(d.errorHandler),c.listen(h,(()=>{console.log(`server is running on port ${h}`)}))},8186:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(1185));if(!process.env.DB_URI)throw new Error("Mongo URI not found in environment");const a=process.env.DB_URI;t.default=()=>r(void 0,void 0,void 0,(function*(){try{yield o.default.connect(a),console.log("Connected to MongoDB")}catch(e){console.log(e),process.exit(1)}}))},9007:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.generateToken=void 0;const i=r(n(9344)),o=process.env.JWT_SECRET||"mySecret";t.generateToken=e=>i.default.sign({id:e},o,{expiresIn:"3d"})},7678:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.generateRefreshToken=void 0;const i=r(n(9344)),o=process.env.JWT_SECRET||"mySecret";t.generateRefreshToken=e=>i.default.sign({id:e},o,{expiresIn:"3d"})},4709:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.addNewArticle=void 0;const o=i(n(5159)),a=i(n(2776)),u=i(n(6178)),s=i(n(2747)),l=i(n(1175)),d=i(n(9396)),f=(0,a.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){var n;try{if(!(null===(n=e.user)||void 0===n?void 0:n._id))throw new Error("Unauthorized request!");const{_id:r}=e.user;(0,d.default)(r);const{categories:i,tags:a,title:f,status:c,url:h,imgUrl:p,content:m,contentType:g,template:y,allowComment:v,publishedAt:w}=e.body;if(i&&i.length>0&&(yield u.default.find({_id:{$in:i}})).length!==i.length)throw new Error("Categories doesn't exist");if(a&&a.length>0&&(yield s.default.find({_id:{$in:a}})).length!==i.length)throw new Error("Tags doesn't exist");if(h!==(0,l.default)(h))throw new Error("url is not in the right format");const _=new o.default(Object.assign(Object.assign(Object.assign({categories:i||[],tags:a||[],title:f,author:r,status:c||"published",url:h,imgUrl:p},m&&{content:m}),g&&{contentType:g}),{template:y||0,allowComment:v||!0,publishedAt:w})),b=yield _.save();t.status(200).json(b)}catch(e){throw new Error(e)}}))));t.addNewArticle=f},3193:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSingleArticle=void 0;const o=i(n(5159)),a=(0,i(n(2776)).default)(((e,t)=>r(void 0,void 0,void 0,(function*(){try{if(!e.params.slug)throw new Error("Slug is required");const n=yield o.default.findOneAndDelete({url:e.params.slug});t.status(200).json(n)}catch(e){throw new Error(e)}}))));t.deleteSingleArticle=a},2025:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleLimit=void 0,t.handleLimit=e=>({limit:Number(e&&e<=20?e:20),maxLimit:20})},4698:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.lookupPipeline=void 0,t.lookupPipeline=[{$lookup:{from:"categories",localField:"categories",foreignField:"_id",as:"categories"}},{$lookup:{from:"tags",localField:"tags",foreignField:"_id",as:"tags"}},{$lookup:{from:"users",localField:"author",foreignField:"_id",as:"author"}},{$addFields:{author:{$arrayElemAt:["$author",0]}}},{$project:{"author.password":0,"author.role":0}}]},9078:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getAllArticlesForAdmin=t.getAllArticles=void 0;const o=i(n(5159)),a=i(n(2776)),u=n(4698),s=n(2025),l=(0,a.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){try{const{limit:n,maxLimit:r}=(0,s.handleLimit)(e.query.limit),i=Number(e.query.page||1),a=yield o.default.countDocuments({status:"published"}),l=yield o.default.aggregate([{$match:{status:"published"}},...u.lookupPipeline]).sort({createdAt:e.query.sort||"desc"}).limit(n).skip((i-1)*n);t.status(200).json({articles:l,page:i,limit:n,maxLimit:r,totalArticles:a})}catch(e){throw new Error(e)}}))));t.getAllArticles=l;const d=(0,a.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){var n;try{const{limit:r,maxLimit:i}=(0,s.handleLimit)(e.query.limit),a=Number(e.query.page||1),l=null===(n=e.query.status)||void 0===n?void 0:n.split(","),d=yield o.default.countDocuments(Object.assign({},l?{status:{$in:l}}:{})),f=yield o.default.aggregate([...l?[{$match:{status:{$in:l}}}]:[],...u.lookupPipeline]).sort({createdAt:e.query.sort||"desc"}).limit(r).skip((a-1)*r);t.status(200).json({articles:f,page:a,limit:r,maxLimit:i,totalArticles:d})}catch(e){throw new Error(e)}}))));t.getAllArticlesForAdmin=d},1218:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.matchLookupFunc=void 0;const i=r(n(1185));t.matchLookupFunc=e=>[{$match:{categories:{$in:[new i.default.Types.ObjectId(e)]}}}]},6544:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getArticlesByCategoryForAdmin=t.getArticlesByCategory=void 0;const o=i(n(5159)),a=i(n(2776)),u=n(1218),s=n(4698),l=n(2025),d=i(n(6178)),f=i(n(1185)),c=(0,a.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){var n;try{if(!e.params.slug)throw new Error("Category id not provided");const r=yield d.default.findOne({slug:e.params.slug});if(!r)throw new Error("Category not found");const{limit:i,maxLimit:a}=(0,l.handleLimit)(e.query.limit),c=Number(e.query.page||1),h=null===(n=e.query.status)||void 0===n?void 0:n.split(","),p=yield o.default.find(Object.assign(Object.assign({},h?{status:{$in:h}}:{}),{categories:{$in:[new f.default.Types.ObjectId(r._id)]}})).countDocuments(),m=yield o.default.aggregate([...h?[{$match:{status:{$in:h}}}]:[],...(0,u.matchLookupFunc)(r._id),...s.lookupPipeline]).sort({createdAt:e.query.sort||"desc"}).limit(i).skip((c-1)*i);t.status(200).json({articles:m,page:c,limit:i,maxLimit:a,totalArticles:p})}catch(e){throw new Error(e)}}))));t.getArticlesByCategoryForAdmin=c;const h=(0,a.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){try{if(!e.params.slug)throw new Error("Category id not provided");const n=yield d.default.findOne({slug:e.params.slug});if(!n)throw new Error("Category not found");const{limit:r,maxLimit:i}=(0,l.handleLimit)(e.query.limit),a=Number(e.query.page||1),c=yield o.default.find({status:"published",categories:{$in:[new f.default.Types.ObjectId(n._id)]}}).countDocuments(),h=yield o.default.aggregate([{$match:{status:"published"}},...(0,u.matchLookupFunc)(n._id),...s.lookupPipeline]).sort({createdAt:e.query.sort||"desc"}).limit(r).skip((a-1)*r);t.status(200).json({articles:h,page:a,limit:r,maxLimit:i,totalArticles:c})}catch(e){throw new Error(e)}}))));t.getArticlesByCategory=h},8804:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.matchLookupFunc=void 0;const i=r(n(1185));t.matchLookupFunc=e=>[{$match:{tags:{$in:[new i.default.Types.ObjectId(e)]}}}]},7259:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getArticlesByTagForAdmin=t.getArticlesByTag=void 0;const o=i(n(5159)),a=i(n(2776)),u=n(8804),s=n(4698),l=n(2025),d=i(n(2747)),f=i(n(1185)),c=(0,a.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){try{if(!e.params.slug)throw new Error("Tag id not provided");const n=yield d.default.findOne({slug:e.params.slug});if(!n)throw new Error("Tag not found");const{limit:r,maxLimit:i}=(0,l.handleLimit)(e.query.limit),a=Number(e.query.page||1),c=yield o.default.find({status:"published",tags:{$in:[new f.default.Types.ObjectId(n._id)]}}).countDocuments(),h=yield o.default.aggregate([{$match:{status:"published"}},...(0,u.matchLookupFunc)(n._id),...s.lookupPipeline]).sort({createdAt:e.query.sort||"desc"}).limit(r).skip((a-1)*r);t.status(200).json({articles:h,page:a,limit:r,maxLimit:i,totalArticles:c})}catch(e){throw new Error(e)}}))));t.getArticlesByTag=c;const h=(0,a.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){var n;try{if(!e.params.slug)throw new Error("Tag id not provided");const r=yield d.default.findOne({slug:e.params.slug});if(!r)throw new Error("Tag not found");const{limit:i,maxLimit:a}=(0,l.handleLimit)(e.query.limit),c=Number(e.query.page||1),h=null===(n=e.query.status)||void 0===n?void 0:n.split(","),p=yield o.default.find(Object.assign(Object.assign({},h?{status:{$in:h}}:{}),{tags:{$in:[new f.default.Types.ObjectId(r._id)]}})).countDocuments(),m=yield o.default.aggregate([...h?[{$match:{status:{$in:h}}}]:[],...(0,u.matchLookupFunc)(r._id),...s.lookupPipeline]).sort({createdAt:e.query.sort||"desc"}).limit(i).skip((c-1)*i);t.status(200).json({articles:m,page:c,limit:i,maxLimit:a,totalArticles:p})}catch(e){throw new Error(e)}}))));t.getArticlesByTagForAdmin=h},121:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getSingleArticleForAdmin=t.getSingleArticle=void 0;const o=i(n(2776)),a=i(n(5159)),u=(0,o.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){try{if(!e.params.slug)throw new Error("Slug is required");const n=yield a.default.findOne({url:e.params.slug,status:"published"});t.status(200).json(n)}catch(e){throw new Error(e)}}))));t.getSingleArticle=u;const s=(0,o.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){try{if(!e.params.slug)throw new Error("Slug is required");const n=yield a.default.findOne({url:e.params.slug});t.status(200).json(n)}catch(e){throw new Error(e)}}))));t.getSingleArticleForAdmin=s},634:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.updateArticle=void 0;const o=i(n(5159)),a=i(n(2776)),u=i(n(6178)),s=i(n(2747)),l=i(n(1175)),d=i(n(9396)),f=(0,a.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){var n;try{if(!(null===(n=e.user)||void 0===n?void 0:n._id))throw new Error("Unauthorized request!");const{_id:r}=e.user;(0,d.default)(r);const{categories:i,tags:a,title:f,status:c,url:h,imgUrl:p,content:m,contentType:g,template:y,allowComment:v,publishedAt:w}=e.body;if(i&&i.length>0&&(yield u.default.find({_id:{$in:i}})).length!==i.length)throw new Error("Categories doesn't exist");if(a&&a.length>0&&(yield s.default.find({_id:{$in:a}})).length!==a.length)throw new Error("Tags doesn't exist");const _=yield o.default.findOneAndUpdate({url:e.params.slug},Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},i&&{categories:i}),a&&{tags:a}),f&&{title:f}),r&&{author:r}),c&&{status:c}),h&&{url:(0,l.default)(h)}),p&&{imgUrl:p}),m&&{content:m}),g&&{contentType:g}),y&&{template:y}),v&&{allowComment:v}),w&&{publishedAt:w}),{new:!0});t.status(200).json(_)}catch(e){throw new Error(e)}}))));t.updateArticle=f},9558:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getMyProfile=t.updateProfile=t.deleteProfile=t.getProfile=void 0;const o=i(n(909)),a=i(n(2776)),u=i(n(9396)),s=(0,a.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){const n=e.user;if(!n)throw new Error("no user found");try{const e=yield o.default.findById(n._id).select("-password");if(!e)throw new Error("User doesn't exist");t.send(e)}catch(e){throw new Error(e)}}))));t.getMyProfile=s;const l=(0,a.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){const{id:n}=e.params;(0,u.default)(n);try{const e=yield o.default.findById(n).select("-password");if(!e)throw new Error("User doesn't exist");t.send(e)}catch(e){throw new Error(e)}}))));t.getProfile=l;const d=(0,a.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){const{id:n}=e.params;(0,u.default)(n);const{firstName:r,lastName:i,email:a,mobile:s}=e.body,l=[];if(a&&((yield o.default.findOne({_id:n,email:a}))?l.push("Email already in use!"):(yield o.default.findOne({_id:{$ne:n},email:a}))&&l.push("Email already exists!")),s&&((yield o.default.findOne({_id:n,mobile:s}))?l.push("Mobile already in use!"):(yield o.default.findOne({_id:{$ne:n},mobile:s}))&&l.push("Mobile no. already exists!")),l.length>0)throw new Error(l.join(", "));try{const e=Object.fromEntries(Object.entries({firstName:r,lastName:i,email:a,mobile:s}).map((([e,t])=>[e,t||null]))),u=yield o.default.findOneAndUpdate({_id:n},e,{new:!0}).select("-password");if(!u)throw new Error("User doesn't exist");t.send(u)}catch(e){throw new Error(e)}}))));t.updateProfile=d;const f=(0,a.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){const{id:n}=e.params;(0,u.default)(n);try{const e=yield o.default.findByIdAndDelete(n).select("-password");if(!e)throw new Error("User doesn't exist");t.send(e)}catch(e){throw new Error(e)}}))));t.deleteProfile=f},8739:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleRefreshToken=t.loginAdmin=t.loginUser=t.createUserByAdmin=t.createRegularUser=void 0;const a=o(n(909)),u=o(n(2776)),s=n(9007),l=o(n(9396)),d=n(7678),f=o(n(9344)),c=process.env.JWT_SECRET||"mySecret",h=(0,u.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){try{const{email:n,role:r,firstName:i,mobile:o,password:u,lastName:s}=e.body;if(r&&"user"!==r)throw new Error("You don't have to premission to create a admin user");if(yield a.default.findOne({email:n}))throw new Error("User already exists!");{const e=yield a.default.create({email:n,firstName:i,mobile:o,password:u,lastName:s});t.json(e)}}catch(e){throw new Error(e)}}))));t.createRegularUser=h;const p=(0,u.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){try{const{email:n,password:r}=e.body,o=yield a.default.findOne({email:n});if(!o)throw new Error("User doesn't exist!");if(!(yield o.isPasswordMatched(r)))throw new Error("Incorrect Password!");{const e=o.toJSON(),n=(()=>{const t=e,{password:n,refreshToken:r}=t;return i(t,["password","refreshToken"])})(),r=(0,d.generateRefreshToken)(null==o?void 0:o._id);yield a.default.findByIdAndUpdate(null==o?void 0:o.id,{refreshToken:r},{new:!0}),t.json({profile:n,refreshToken:r,expiry:2592e5,token:(0,s.generateToken)(o._id)})}}catch(e){throw new Error(e)}}))));t.loginUser=p;const m=(0,u.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){try{if(!e.user)throw new Error("Unauthorized request!");const{_id:n}=e.user;(0,l.default)(n);const{email:r,role:i,firstName:o,mobile:u,password:s,lastName:d}=e.body;if(yield a.default.findOne({email:r}))throw new Error("User already exists!");{const e=yield a.default.create({email:r,role:i,firstName:o,mobile:u,password:s,lastName:d});t.json(e)}}catch(e){throw new Error(e)}}))));t.createUserByAdmin=m;const g=(0,u.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){try{const{email:n,password:r}=e.body,o=yield a.default.findOne({email:n});if(!o)throw new Error("User doesn't exist!");if(!(yield o.isPasswordMatched(r)))throw new Error("Incorrect Password!");{const e=o.toJSON();if("admin"!==e.role)throw new Error("You are not an Admin");const{password:n}=e,r=i(e,["password"]);t.json(Object.assign(Object.assign({},r),{token:(0,s.generateToken)(o._id)}))}}catch(e){throw new Error(e)}}))));t.loginAdmin=g;const y=(0,u.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){try{const n=e.body.refreshToken;if(!n)throw new Error("No refresh token received");const r=yield a.default.findOne({refreshToken:n});if(!r)throw new Error("User not found by refreshToken or token expired");f.default.verify(n,c,((e,o)=>{if(e||r._id.toString()!==o.id)throw new Error("Something went wrong in refreshToken process");const a=r.toJSON(),u=(()=>{const e=a,{password:t,refreshToken:n}=e;return i(e,["password","refreshToken"])})(),l=(0,s.generateToken)(r._id);t.json({profile:u,refreshToken:n,expiry:2592e5,token:l})}))}catch(e){throw new Error(e)}}))));t.handleRefreshToken=y},5412:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getAllAuthors=void 0;const o=i(n(909)),a=(0,i(n(2776)).default)(((e,t)=>r(void 0,void 0,void 0,(function*(){try{const e=yield o.default.find({role:"admin"}).select(["-refreshToken","-password"]);t.status(200).json(e)}catch(e){throw new Error(e)}}))));t.getAllAuthors=a},5841:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.addNewCategory=t.getSingleCategory=t.getAllCategories=void 0;const o=i(n(6178)),a=i(n(2776)),u=i(n(1175)),s=(0,a.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){try{const e=yield o.default.find();t.status(200).json(e)}catch(e){throw new Error(e)}}))));t.getAllCategories=s;const l=(0,a.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){const n=e.params.slug;try{const e=yield o.default.findOne({slug:n});t.status(200).json(e)}catch(e){throw new Error(e)}}))));t.getSingleCategory=l;const d=(0,a.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){const{name:n,slug:r,description:i}=e.body,a=[];if(n||a.push("name not provided"),r||a.push("slug not provided"),a.length>0)throw new Error(a.join(", "));if(r!==(0,u.default)(r))throw new Error("slug is not in the right format");try{const e=new o.default({name:n,slug:r,description:i||null}),a=yield e.save();t.status(200).json(a)}catch(e){throw new Error(e)}}))));t.addNewCategory=d},3367:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.addNewTag=t.getSingleTag=t.getAllTags=void 0;const o=i(n(2747)),a=i(n(2776)),u=i(n(1175)),s=(0,a.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){try{const e=yield o.default.find();t.status(200).json(e)}catch(e){throw new Error(e)}}))));t.getAllTags=s;const l=(0,a.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){const n=e.params.slug;try{const e=yield o.default.findOne({slug:n});t.status(200).json(e)}catch(e){throw new Error(e)}}))));t.getSingleTag=l;const d=(0,a.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){const{name:n,slug:r,description:i}=e.body,a=[];if(n||a.push("tag name not provided"),r||a.push("slug not provided"),a.length>0)throw new Error(a.join(", "));if(r!==(0,u.default)(r))throw new Error("slug is not in the right format");try{const e=new o.default({name:n,slug:r,description:i||null}),a=yield e.save();t.status(200).json(a)}catch(e){throw new Error(e)}}))));t.addNewTag=d},2909:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(2776)),a=i(n(1738)),u=i(n(7441)),s=n(1668),l=n(5414),d=i(n(1175)),f=a.default.memoryStorage(),c=(0,a.default)({storage:f,fileFilter:(e,t,n)=>{t.mimetype.startsWith("image")?n(null,!0):n("Please provide image only!",!1)}}).single("upload"),h=(0,o.default)(((e,t,n)=>r(void 0,void 0,void 0,(function*(){if(!e.file)return n(new Error("Image Buffer not found on server"));const t=(0,d.default)(e.file.originalname.replace(/\.[^/.]+$/,""))+"-"+Date.now().toString()+"-"+Math.round(1e9*Math.random()).toString()+".webp";try{const o=[{name:t,buffer:e.file.buffer},{name:`${t}-1024xauto.webp`,buffer:yield(i=e.file,1024,null,r(void 0,void 0,void 0,(function*(){return yield(0,u.default)(i.buffer).resize(1024,null,{fit:"cover",position:"center",withoutEnlargement:!0}).toFormat("webp").webp({quality:90}).toBuffer()})))}],a=[],d="images",f=o.map((({name:e,buffer:t})=>r(void 0,void 0,void 0,(function*(){const n=(0,s.ref)(l.storage,`${d}/`+e);yield(0,s.uploadBytes)(n,t);const r=yield(0,s.getDownloadURL)(n);a.push({name:e,downloadURL:r})}))));yield Promise.all(f),e.body.images={success:`File ${t} uploaded successfully.`,path:d,filename:t,fullpath:`${d}/${t}`,images:a},n()}catch(e){n(new Error("Something went wrong"))}var i})))),p=(0,o.default)(((e,t)=>{var n;if(!e.body.images)throw new Error("Internal Server error");t.send({url:null===(n=e.body.images.images.find((t=>t.name=e.body.images.filename+"-1024xauto.webp")))||void 0===n?void 0:n.downloadURL})}));t.default={uploadImage:(e,t,n)=>{c(e,t,(e=>{if(e)return n(new Error(e));n()}))},resizeImage:h,getResult:p}},8122:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getResult=t.resizeImage=t.uploadImage=void 0;const o=i(n(2776)),a=i(n(1738)),u=i(n(7441)),s=n(1668),l=n(5414),d=i(n(1175)),f=a.default.memoryStorage(),c=(0,a.default)({storage:f,fileFilter:(e,t,n)=>{t.mimetype.startsWith("image")?n(null,!0):n("Please provide image only!",!1)}}).single("image");t.uploadImage=(e,t,n)=>{c(e,t,(e=>{if(e)return n(new Error(e));n()}))};const h=(e,t,n)=>r(void 0,void 0,void 0,(function*(){return yield(0,u.default)(e.buffer).resize(t,n,{fit:"cover",position:"center",withoutEnlargement:!0}).toFormat("webp").webp({quality:90}).toBuffer()})),p=(0,o.default)(((e,t,n)=>r(void 0,void 0,void 0,(function*(){if(!e.file)return n(new Error("Image Buffer not found on server"));const t=(0,d.default)(e.file.originalname.replace(/\.[^/.]+$/,""))+"-"+Date.now().toString()+"-"+Math.round(1e9*Math.random()).toString()+".webp";try{const i=[{name:t,buffer:e.file.buffer},{name:`${t}-150x150.webp`,buffer:yield h(e.file,150,150)},{name:`${t}-485x360.webp`,buffer:yield h(e.file,485,360)},{name:`${t}-218x150.webp`,buffer:yield h(e.file,218,150)},{name:`${t}-696xauto.webp`,buffer:yield h(e.file,696,null)}],o=[],a="images",u=i.map((({name:e,buffer:t})=>r(void 0,void 0,void 0,(function*(){const n=(0,s.ref)(l.storage,`${a}/`+e);yield(0,s.uploadBytes)(n,t);const r=yield(0,s.getDownloadURL)(n);o.push({name:e,downloadURL:r})}))));yield Promise.all(u),e.body.images={success:`File ${t} uploaded successfully.`,path:a,filename:t,fullpath:`${a}/${t}`,images:o},n()}catch(e){n(new Error("Something went wrong"))}}))));t.resizeImage=p;const m=(0,o.default)(((e,t)=>{if(!e.body.images)throw new Error("Internal Server error");t.send(Object.assign({},e.body.images))}));t.getResult=m},4157:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getResults=t.resizeImages=t.uploadImages=void 0;const o=i(n(2776)),a=i(n(1738)),u=i(n(7441)),s=n(1668),l=n(5414),d=i(n(1175)),f=a.default.memoryStorage(),c=(0,a.default)({storage:f,fileFilter:(e,t,n)=>{t.mimetype.startsWith("image")?n(null,!0):n("Please provide image only!",!1)}}).array("image",10);t.uploadImages=(e,t,n)=>{c(e,t,(e=>{if(e)return e instanceof a.default.MulterError&&"LIMIT_UNEXPECTED_FILE"===e.code?n(new Error("Too many files uploaded! Max 10 allowed")):n(new Error(e));n()}))};const h=(e,t,n)=>r(void 0,void 0,void 0,(function*(){return yield(0,u.default)(e.buffer).resize(t,n,{fit:"cover",position:"center",withoutEnlargement:!0}).toFormat("webp").webp({quality:90}).toBuffer()})),p=(0,o.default)(((e,t,n)=>r(void 0,void 0,void 0,(function*(){if(!e.files)return n(new Error("Image Buffer not found on server"));const t=[];yield Promise.all(e.files.map((e=>r(void 0,void 0,void 0,(function*(){const i=(0,d.default)(e.originalname.replace(/\.[^/.]+$/,""))+"-"+Date.now().toString()+"-"+Math.round(1e9*Math.random()).toString()+".webp";try{const n=[{name:i,buffer:e.buffer},{name:`${i}-150x150.webp`,buffer:yield h(e,150,150)},{name:`${i}-485x360.webp`,buffer:yield h(e,485,360)},{name:`${i}-218x150.webp`,buffer:yield h(e,218,150)},{name:`${i}-696xauto.webp`,buffer:yield h(e,696,null)}],o=[],a="images",u=n.map((({name:e,buffer:t})=>r(void 0,void 0,void 0,(function*(){const n=(0,s.ref)(l.storage,`${a}/`+e);yield(0,s.uploadBytes)(n,t);const r=yield(0,s.getDownloadURL)(n);o.push({name:e,downloadURL:r})}))));yield Promise.all(u),t.push({success:`File ${i} uploaded successfully.`,path:a,filename:i,fullpath:`${a}/${i}`,images:o})}catch(e){n(new Error("Something went wrong"))}}))))),e.body.images=t,n()}))));t.resizeImages=p;const m=(0,o.default)(((e,t)=>{if(!e.body.images)throw new Error("Internal Server error");t.send(Object.assign({},e.body.images))}));t.getResults=m},5438:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.updateProfile=t.getProfile=void 0;const o=i(n(909)),a=i(n(2776)),u=i(n(9396)),s=(0,a.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){var n;if(!(null===(n=e.user)||void 0===n?void 0:n._id))throw new Error("Unauthorized request!");const{_id:r}=e.user;(0,u.default)(r);try{const e=yield o.default.findById(r).select("-password");if(!e)throw new Error("User doesn't exist");t.send(e)}catch(e){throw new Error(e)}}))));t.getProfile=s;const l=(0,a.default)(((e,t)=>r(void 0,void 0,void 0,(function*(){var n;if(!(null===(n=e.user)||void 0===n?void 0:n._id))throw new Error("Unauthorized request!");const{_id:r}=e.user;(0,u.default)(r);const{firstName:i,lastName:a,email:s,mobile:l}=e.body,d=[];if(s&&((yield o.default.findOne({_id:r,email:s}))?d.push("Email already in use!"):(yield o.default.findOne({_id:{$ne:r},email:s}))&&d.push("Email already exists!")),l&&((yield o.default.findOne({_id:r,mobile:l}))?d.push("Mobile already in use!"):(yield o.default.findOne({_id:{$ne:r},mobile:l}))&&d.push("Mobile no. already exists!")),d.length>0)throw Object.assign(new Error("Couldn't update profile"),{messages:d});try{const e=Object.fromEntries(Object.entries({firstName:i,lastName:a,email:s,mobile:l}).map((([e,t])=>[e,t||null]))),n=yield o.default.findOneAndUpdate({_id:r},e,{new:!0}).select("-password");if(!n)throw new Error("User doesn't exist");t.send(n)}catch(e){throw new Error(e)}}))));t.updateProfile=l},5414:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.storage=t.app=void 0;const r=n(4324),i=n(1668),o=(0,r.initializeApp)({apiKey:"AIzaSyDxLnauPiSKjkg4VISvM2RNLMrIAjiywys",authDomain:"newspaper-12-74161.firebaseapp.com",projectId:"newspaper-12-74161",storageBucket:"newspaper-12-74161.appspot.com",messagingSenderId:"1058521079669",appId:"1:1058521079669:web:4793ec8cba945114d33d3c",measurementId:"G-L6TJFS93MH"});t.app=o;const a=(0,i.getStorage)(o);t.storage=a},8529:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.isAdmin=t.authMiddleware=void 0;const o=i(n(909)),a=i(n(9344)),u=i(n(2776)),s=(0,u.default)(((e,t,n)=>r(void 0,void 0,void 0,(function*(){var t;let r;if(!(null===(t=e.headers.authorization)||void 0===t?void 0:t.startsWith("Bearer")))throw new Error("No Access token received");r=e.headers.authorization.split(" ")[1];try{if(r){if(!process.env.JWT_SECRET)throw new Error("JWT_SECRET not found in environment");const t=a.default.verify(r,process.env.JWT_SECRET);if("string"==typeof t)throw new Error("Invalid Access Token");const i=yield o.default.findById(null==t?void 0:t.id);if(!i)throw new Error("User not found");e.user=i,n()}}catch(e){if(!process.env.JWT_SECRET)throw new Error(e);throw new Error("Unauthrized: token expired plz login again")}}))));t.authMiddleware=s;const l=(0,u.default)(((e,t,n)=>r(void 0,void 0,void 0,(function*(){try{if(!e.user)throw new Error("No user received!");const{_id:t}=e.user,r=yield o.default.findById(t);if(r&&"admin"!==r.role)throw new Error("You are not an admin user");n()}catch(e){throw new Error(e)}}))));t.isAdmin=l},8394:function(e,t){var n=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.errorHandler=t.notFound=void 0,t.notFound=(e,t,n)=>{const r=new Error(`Not Found: ${e.originalUrl}`);t.status(404),n(r)},t.errorHandler=(e,t,r,i)=>{const o=200===r.statusCode?500:r.statusCode;r.status(o);const{name:a,message:u}=e,s=n(e,["name","message"]);r.json({status:o,name:a,message:u,details:Object.assign({},s)})}},5159:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const a=o(n(1185)),u=new a.default.Schema({categories:{type:[a.Schema.Types.ObjectId],default:[]},tags:{type:[a.Schema.Types.ObjectId],default:[]},title:{type:String,require:!0,message:"title not provided",min:[3,"Titie can't be less than 3 characters"],max:[150,"Title can't be greater than 150 words"]},description:{type:String,require:!0},author:a.Schema.Types.ObjectId,status:{type:String,require:!0,enum:{values:["published","draft","trash"],message:"status '{VALUE}' is not supported"},default:"draft"},views:{type:Number,default:0},url:{type:String,require:!0,unique:!0,message:"url not provided"},imgUrl:{type:String,require:!0,message:"image url not provided"},content:{type:String,default:null},contentType:{type:String,enum:{values:["post","video","audio","news"],message:"contentType '{VALUE}' is not supported"},default:"post"},template:{type:Number,default:0},allowComment:{type:Boolean,default:!0},publishedAt:{type:String,required:!0,message:"please provide publish date",default:(new Date).toISOString()}},{timestamps:!0});t.default=a.default.model("Article",u)},6178:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const a=o(n(1185)),u=new a.default.Schema({name:{type:String,require:!0,message:"category name not provided"},slug:{type:String,require:!0,unique:!0,message:"slug not provided"},description:{type:String,default:null},parent:{type:a.Schema.Types.ObjectId,default:null}},{timestamps:!0});t.default=a.default.model("Categorie",u)},2747:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(1185)),o=new i.default.Schema({name:{type:String,require:!0,message:"tag name not provided"},slug:{type:String,require:!0,unique:!0,message:"slug not provided"},description:{type:String,default:null}},{timestamps:!0});t.default=i.default.model("Tag",o)},909:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(1185)),a=i(n(7096)),u=new o.default.Schema({firstName:{type:String,required:!0,min:[3,"FirstName can't be less than 3 characters"]},lastName:{type:String,min:[3,"LastName can't be less than 3 characters"]},email:{type:String,required:!0,unique:!0,validate(e){if(!e.match(/^[\w-\\.]+@([\w-]+\.)+[\w-]{2,4}$/))throw new Error("Invalid email address")}},mobile:{type:String,required:!0,unique:!0,validate(e){if(!e.match(/^[0-9]{10}$/))throw new Error("Invalid mobile number")}},password:{type:String,required:!0,min:[5,"Password must at least 5 characters long!"]},role:{type:String,enum:{values:["user","admin"],message:"role '{VALUE}' not supported!"},default:"user"},refreshToken:{type:String}});u.pre("save",(function(){return r(this,void 0,void 0,(function*(){const e=yield a.default.genSalt(10);this.password=yield a.default.hash(this.password,e)}))})),u.methods.isPasswordMatched=function(e){return r(this,void 0,void 0,(function*(){return yield a.default.compare(e,this.password)}))},t.default=o.default.model("User",u)},9825:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=n(4709),a=n(3193),u=n(8529),s=n(634),l=n(121),d=i.default.Router();d.get("/:slug",u.authMiddleware,u.isAdmin,l.getSingleArticleForAdmin),d.post("/",u.authMiddleware,u.isAdmin,o.addNewArticle),d.put("/:slug",u.authMiddleware,u.isAdmin,s.updateArticle),d.delete("/:slug",u.authMiddleware,u.isAdmin,a.deleteSingleArticle),t.default=d},6974:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=n(8529),a=n(9078),u=n(6544),s=n(7259),l=i.default.Router();l.get("/",o.authMiddleware,o.isAdmin,a.getAllArticlesForAdmin),l.get("/category/:slug",o.authMiddleware,o.isAdmin,u.getArticlesByCategoryForAdmin),l.get("/tag/:slug",o.authMiddleware,o.isAdmin,s.getArticlesByTagForAdmin),t.default=l},4360:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(5412),o=r(n(6860)).default.Router();o.get("/all",i.getAllAuthors),t.default=o},1200:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=n(5841),a=i.default.Router();a.get("/",o.getAllCategories),t.default=a},123:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=n(5841),a=n(8529),u=i.default.Router();u.get("/:slug",o.getSingleCategory),u.post("/",a.authMiddleware,a.isAdmin,o.addNewCategory),t.default=u},8664:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=n(9558),a=n(8529),u=i.default.Router();u.get("/",a.authMiddleware,a.isAdmin,o.getMyProfile),u.get("/:id",a.authMiddleware,a.isAdmin,o.getProfile),u.delete("/:id",a.authMiddleware,a.isAdmin,o.deleteProfile),u.put("/:id",a.authMiddleware,a.isAdmin,o.updateProfile),t.default=u},855:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=n(3367),a=n(8529),u=i.default.Router();u.get("/:slug",o.getSingleTag),u.post("/",a.authMiddleware,a.isAdmin,o.addNewTag),t.default=u},794:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=n(3367),a=i.default.Router();a.get("/",o.getAllTags),t.default=a},7487:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=n(8122),a=r(n(2909)),u=n(4157),s=i.default.Router();s.post("/image",o.uploadImage,o.resizeImage,o.getResult),s.post("/ckimage",a.default.uploadImage,a.default.resizeImage,a.default.getResult),s.post("/images",u.uploadImages,u.resizeImages,u.getResults),t.default=s},2743:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=r(n(9825)),a=r(n(6974)),u=r(n(8664)),s=r(n(123)),l=r(n(1200)),d=n(8739),f=n(8529),c=r(n(855)),h=r(n(794)),p=r(n(7487)),m=r(n(4360)),g=i.default.Router();g.use("/article",o.default),g.use("/articles",a.default),g.use("/profile",u.default),g.post("/register",f.authMiddleware,f.isAdmin,d.createUserByAdmin),g.use("/category",s.default),g.use("/categories",l.default),g.use("/tag",c.default),g.use("/tags",h.default),g.post("/login",d.loginAdmin),g.use("/upload",f.authMiddleware,f.isAdmin,p.default),g.use("/authors",f.authMiddleware,f.isAdmin,m.default),t.default=g},4282:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=n(121),a=i.default.Router();a.get("/:slug",o.getSingleArticle),t.default=a},7942:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=n(9078),a=n(6544),u=n(7259),s=i.default.Router();s.get("/all",o.getAllArticles),s.get("/category/:slug",a.getArticlesByCategory),s.get("/tag/:slug",u.getArticlesByTag),t.default=s},3866:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=n(5841),a=i.default.Router();a.get("/",o.getAllCategories),t.default=a},2513:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=n(5841),a=i.default.Router();a.get("/:slug",o.getSingleCategory),t.default=a},2285:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=n(3367),a=i.default.Router();a.get("/:slug",o.getSingleTag),t.default=a},2167:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=n(3367),a=i.default.Router();a.get("/",o.getAllTags),t.default=a},2166:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=r(n(4282)),a=r(n(7942)),u=r(n(2513)),s=r(n(2285)),l=r(n(2167)),d=r(n(3866)),f=i.default.Router();f.use("/article",o.default),f.use("/articles",a.default),f.use("/category",u.default),f.use("/categories",d.default),f.use("/tag",s.default),f.use("/tags",l.default),t.default=f},7714:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=n(5438),a=n(8529),u=i.default.Router();u.get("/",a.authMiddleware,o.getProfile),u.put("/",a.authMiddleware,o.updateProfile),t.default=u},1845:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=r(n(7714)),a=i.default.Router();a.use("/profile",o.default),t.default=a},8966:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=n(8739),a=i.default.Router();a.post("/register",o.createRegularUser),a.post("/login",o.loginUser),a.post("/refreshtoken",o.handleRefreshToken),t.default=a},1175:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.trim().toLowerCase().replace(/[^\w\s-]/gi,"").replace(/\s+/g,"-").replace(/^-+/,"").replace(/-+$/,"").replace(/-{2,}/g,"-")}},9396:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(1185));t.default=e=>{if(!i.default.Types.ObjectId.isValid(e))throw new Error("This id is not valid or not found")}},7096:e=>{e.exports=require("bcrypt")},3582:e=>{e.exports=require("cors")},6860:e=>{e.exports=require("express")},2776:e=>{e.exports=require("express-async-handler")},4324:e=>{e.exports=require("firebase/app")},1668:e=>{e.exports=require("firebase/storage")},9344:e=>{e.exports=require("jsonwebtoken")},1185:e=>{e.exports=require("mongoose")},1738:e=>{e.exports=require("multer")},7441:e=>{e.exports=require("sharp")}},t={};!function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}(6752)})();